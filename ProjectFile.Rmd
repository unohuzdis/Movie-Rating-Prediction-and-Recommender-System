---
title: "Project311"
author: "Pardeep Rathore + 71364251"
date: "March 11, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
movies<- read.csv(file = "P:/Term4/DATA311/Project/imdb-data-from-2006-to-2016/OriginalDS/IMDB-Movie-Data.csv")
names(movies)
attach(movies)
slr <- lm(Rank ~ Revenue..Millions.) 
summary(slr)
```

## Fixing NA values
varibale named NewMovieDS has no NA values
```{r}
any(is.na(movies))
#sum(is.na(movies))
#colSums(is.na(movies))
New_MovieDS <- na.omit(movies)
any(is.na(New_MovieDS))
#nrow(NewMovieDS)
#NewMovieDS2 <- movies[complete.cases(movies),]
#nrow(NewMovieDS2)
#View(NewMovieDS)
```

##Creating training and testing datasets
```{r}
#Splitiing dataset into training and testing
#ind <- sample(2, nrow(New_MovieDS), replace = TRUE, prob = c(0.5,0.5))
#train.data = New_MovieDS[ind==1,]
#test.data = New_MovieDS[ind==2,]

train <- sample(1:nrow(New_MovieDS), nrow(New_MovieDS)/2)
test <- -train
train.data <- New_MovieDS[train,]
test.data <- New_MovieDS[test,]


#View(NewMovieDS)
New_MovieDS$NewGenre <- gsub(",.*","", New_MovieDS[,3])
#newGenre
#genre
names(New_MovieDS)
```


```{r}
library(MASS)
attach(New_MovieDS)
ldafit <- lda(Revenue..Millions. ~ Rank + Runtime..Minutes., data=New_MovieDS )
#ldafit
#ldapred <- predict(ldafit,NewMovieDS)
#ldaClass <- ldapred$class
#table(ldaClass,NewMovieDS$Revenue..Millions.)
```


##Classification tree
```{r}
library(tree)
library(gclus)
#attach(movies)
data(New_MovieDS)
set.seed(12412)
New_MovieDS$NewGenre <- factor(New_MovieDS$NewGenre)
bod <- data.frame(New_MovieDS)
bocl <- tree(NewGenre ~ Rank+Runtime..Minutes.+Rating+Votes+Revenue..Millions.+Metascore , data=bod)
plot(bocl)
text(bocl)
```

##Pruning
```{r}
cv.bocl <- cv.tree(bocl, FUN = prune.misclass)
plot(cv.bocl, type="b")
```

## Minimum is at 8
```{r}
p.bocl <- prune.misclass(bocl, best=8)
plot(p.bocl)
text(p.bocl)
summary(p.bocl)
```

##Random Forest
```{r}
library(randomForest)
library(caret)
set.seed(12)
RandomForest <-randomForest(Revenue..Millions. ~ Runtime..Minutes. + Rating + Votes + Rank + Metascore ,data= train.data,importance=TRUE)
RandomForest
p1 <- predict(RandomForest,test.data)
mean((p1-test.data$Revenue..Millions.)^2)
plot(RandomForest)
varImpPlot(RandomForest)
```

